<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Dong Chenyou's HKU portfolio: Blending AI, chemistry, and stories." />
  <title>Dong Chenyou | HKU Storyteller</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Georgia', serif; }
    .logo-img { width: 48px; height: 48px; object-fit: contain; filter: brightness(1.1) contrast(1.2); }
    .music-control { position: fixed; bottom: 24px; right: 24px; z-index: 50; }
    .music-btn { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 50%; width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; box-shadow: 0 6px 20px rgba(2,6,23,0.2); }
    .music-btn:hover { transform: scale(1.05); }
    .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; }
    .video-container video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    /* simple notification style */
    .upload-notification { transition: opacity .2s ease; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- 背景音乐播放器：默认引用仓库中的 bgm.mp3 -->
  <audio id="bgMusic" loop src="bgm.mp3"></audio>

  <!-- 音乐控制（右下） -->
  <div class="music-control">
    <label for="musicFile" class="music-btn cursor-pointer" title="Upload your own background music">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10" />
      </svg>
    </label>
    <input type="file" id="musicFile" accept="audio/mp3,audio/ogg,audio/wav" class="hidden">

    <button id="playPauseBtn" class="music-btn mt-3" onclick="togglePlay()" title="Play/Pause">
      <svg id="playIcon" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path id="playPath" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-6.718-3.884A1 1 0 007 8.122v7.756a1 1 0 001.034.938l6.718-3.884a1 1 0 000-1.764z" />
      </svg>
    </button>

    <div class="mt-3 bg-white/90 backdrop-filter backdrop-blur rounded-full p-2 shadow-lg">
      <input type="range" id="volumeSlider" min="0" max="100" value="30" class="w-24 h-2 rounded-lg appearance-none cursor-pointer">
    </div>
  </div>

  <!-- Navbar -->
  <nav class="bg-blue-800 text-white p-4 sticky top-0 shadow-md z-40">
    <div class="container mx-auto flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <!-- 使用仓库里的 logo.png -->
        <img id="siteLogo" src="logo.png" alt="Dong Chenyou Logo" class="logo-img">
        <h1 class="text-2xl font-bold">Dong Chenyou</h1>
      </div>
      <div class="space-x-4">
        <a href="#home" class="hover:text-gray-300">Home</a>
        <a href="#about" class="hover:text-gray-300">About</a>
        <a href="#stories" class="hover:text-gray-300">Stories</a>
        <a href="#videos" class="hover:text-gray-300">Videos</a>
        <a href="#contact" class="hover:text-gray-300">Contact</a>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section id="home" class="bg-gradient-to-b from-blue-900 to-blue-600 py-24 text-center text-white">
    <div class="container mx-auto px-4">
      <h2 class="text-5xl font-bold mb-4">Whispers of Science and Mystery</h2>
      <p class="text-xl mb-6 max-w-2xl mx-auto">Hi, I'm Dong Chenyou—a HKU Chemistry student crafting AI-powered tales that bridge labs and legends.</p>
      <a href="#stories" class="bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 font-semibold">Explore Stories</a>
    </div>
  </section>

  <!-- About -->
  <section id="about" class="py-20 bg-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-4xl font-bold mb-8">About Me</h2>
      <p class="text-lg max-w-3xl mx-auto leading-relaxed mb-6">
        As a first-year Chemistry student at HKU, I spend my days decoding molecules and nights experimenting with AI prompts to birth stories.
      </p>
    </div>
  </section>

  <!-- Stories -->
  <section id="stories" class="py-20 bg-gray-100">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-center mb-10">Story-Telling Board</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-12 max-w-5xl mx-auto">
        <!-- Chapter 1 -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden hover:shadow-2xl transition">
          <div class="bg-gradient-to-br from-purple-100 to-blue-100 p-8 text-center">
            <h3 class="text-3xl font-bold text-purple-900">Chapter 1: The Lantern’s Glow</h3>
            <p class="mt-4 text-gray-700">Word Count: 352</p>
          </div>
          <div class="p-8 text-gray-700 leading-relaxed text-sm">
            <div class="whitespace-pre-wrap">
A Whisper in the Woods

Chapter 1: The Lantern’s Glow

Andy Chen tightened his HKU scarf against the evening chill. As a first-year Chemistry student, he normally spent evenings in the library or gaming with friends. Tonight was different. Campus whi[...]

His lantern swung gently, casting dancing shadows between ancient banyan trees. The city’s distant glow should have made this feel safe, but the forest had its own rules. Brittle leaves crackle[...]

"Probably just wind through bamboo," he muttered to himself. Yet his scientific curiosity kept him moving forward. If there was a natural explanation, he wanted to find it.
            </div>
          </div>
        </div>

        <!-- Chapter 2 -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden hover:shadow-2xl transition">
          <div class="bg-gradient-to-br from-purple-100 to-blue-100 p-8 text-center">
            <h3 class="text-3xl font-bold text-purple-900">Chapter 2: The Keeper’s Choice</h3>
            <p class="mt-4 text-gray-700">Word Count: 372</p>
          </div>
          <div class="p-8 text-gray-700 leading-relaxed text-sm">
            <div class="whitespace-pre-wrap">
Chapter 2 content...
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Video Section -->
  <section id="videos" class="py-20 bg-white">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-bold text-center mb-10">Video Gallery</h2>
      <p class="text-center text-lg mb-12 text-gray-600 max-w-3xl mx-auto">
        Watch behind-the-scenes of my AI storytelling, chemistry experiments, or Lung Fu Shan explorations.
      </p>

      <!-- Upload form -->
      <div class="max-w-2xl mx-auto mb-8 p-8 bg-gray-50 rounded-xl shadow-md">
        <h3 class="text-2xl font-semibold mb-6 text-center">Upload Your Video</h3>
        <form id="videoUploadForm" class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Video Title</label>
            <input type="text" id="videoTitle" placeholder="e.g., My AI Story Creation Process" class="w-full p-3 border rounded-lg" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Video File (MP4, max 100MB)</label>
            <input type="file" id="videoFile" accept="video/mp4" class="w-full p-3 border rounded-lg" required>
          </div>
          <button type="submit" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 font-semibold">Upload Video</button>
        </form>
        <p id="uploadStatus" class="mt-4 text-center hidden"></p>

        <!-- 快速使用仓库内媒体 -->
        <div class="mt-4 text-center">
          <button id="useRepoMedia" class="bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">Use repository media (teaser.mp4 / bgm.mp3 / logo)</button>
        </div>
      </div>

      <!-- Video Grid (初始会显示仓库里的 teaser.mp4，如果存在) -->
      <div id="videoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div id="repoTeaserCard" class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="video-container">
            <!-- 默认指向仓库中的 teaser.mp4（如果存在） -->
            <video controls preload="metadata">
              <source src="teaser.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="p-6">
            <h3 class="text-xl font-semibold mb-2">Teaser</h3>
            <p class="text-gray-600 text-sm">From repository: teaser.mp4</p>
          </div>
        </div>

        <div class="bg-gray-100 border-2 border-dashed rounded-xl p-12 text-center text-gray-500">
          <p class="text-lg font-medium">Your uploaded videos will appear here</p>
          <p class="text-sm mt-2">Start by uploading your first video above!</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="py-20 bg-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-4xl font-bold mb-6">Let's Connect</h2>
      <p class="text-lg mb-8 text-gray-600 max-w-2xl mx-auto">Share thoughts on my stories or collaborate on AI tales.</p>
      <div class="max-w-md mx-auto space-y-4">
        <form id="contactForm" onsubmit="handleSubmit(event)">
          <input type="text" id="name" placeholder="Name" class="w-full p-3 border rounded-lg" required>
          <input type="email" id="email" placeholder="Email" class="w-full p-3 border rounded-lg" required>
          <textarea id="message" placeholder="Message" rows="5" class="w-full p-3 border rounded-lg" required></textarea>
          <button type="submit" class="bg-blue-600 text-white py-3 px-8 rounded-lg hover:bg-blue-700 font-semibold">Send Message</button>
        </form>
        <p id="formMessage" class="hidden mt-4 text-green-600 font-medium"></p>
      </div>
    </div>
  </section>

  <footer class="bg-blue-800 text-white py-8 text-center">
    <p class="text-sm">© 2025 Dong Chenyou. All rights reserved.</p>
  </footer>

  <script>
    // Helpers
    function escapeHtml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }

    function showNotification(msg) {
      const existing = document.querySelector('.upload-notification');
      if (existing) existing.remove();
      const notification = document.createElement('div');
      notification.textContent = msg;
      notification.className = 'upload-notification fixed bottom-32 right-6 bg-black/80 text-white px-4 py-2 rounded-lg text-sm shadow-lg z-50';
      document.body.appendChild(notification);
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 200);
      }, 3000);
    }

    // Audio controls and handling
    const audio = document.getElementById('bgMusic');
    const playPath = document.getElementById('playPath');
    const volumeSlider = document.getElementById('volumeSlider');
    const musicFileInput = document.getElementById('musicFile');
    let isPlaying = false;

    document.addEventListener('DOMContentLoaded', () => {
      // Set default volume and style for slider
      audio.volume = 0.3;
      volumeSlider.value = 30;
      volumeSlider.style.background = `linear-gradient(to right, #3b82f6 0%, #3b82f6 30%, #e5e7eb 30%, #e5e7eb 100%)`;

      // Update play/pause state when audio events happen
      audio.addEventListener('play', () => { isPlaying = true; updatePlayIcon(); });
      audio.addEventListener('pause', () => { isPlaying = false; updatePlayIcon(); });
      audio.addEventListener('ended', () => { isPlaying = false; updatePlayIcon(); });
    });

    musicFileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;
      const validTypes = ['audio/mp3', 'audio/ogg', 'audio/wav', 'audio/mpeg'];
      if (!validTypes.includes(file.type)) {
        alert('Please upload MP3, OGG, WAV files.');
        return;
      }
      const url = URL.createObjectURL(file);
      audio.src = url;
      audio.load();
      audio.play().catch(() => {
        showNotification('Click play to start music (browser blocked autoplay).');
      });
    });

    function togglePlay() {
      if (!audio.src) {
        showNotification('No audio source found. Upload or use repository media.');
        return;
      }
      if (isPlaying) audio.pause();
      else audio.play().catch(() => showNotification('Playback blocked by browser. Please click play.'));
    }

    function updatePlayIcon() {
      if (isPlaying) {
        playPath.setAttribute('d', 'M10 9v6m4-6v6'); // pause icon
      } else {
        playPath.setAttribute('d', 'M14.752 11.168l-6.718-3.884A1 1 0 007 8.122v7.756a1 1 0 001.034.938l6.718-3.884a1 1 0 000-1.764z'); // play icon
      }
    }

    volumeSlider.addEventListener('input', function() {
      audio.volume = this.value / 100;
      this.style.background = `linear-gradient(to right, #3b82f6 0%, #3b82f6 ${this.value}%, #e5e7eb ${this.value}%, #e5e7eb 100%)`;
    });

    // Video upload (client-side preview only)
    document.getElementById('videoUploadForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const title = document.getElementById('videoTitle').value.trim();
      const file = document.getElementById('videoFile').files[0];
      const status = document.getElementById('uploadStatus');
      const grid = document.getElementById('videoGrid');

      if (!title) {
        status.textContent = 'Please enter a video title.'; status.className = 'mt-4 text-center text-red-600'; return;
      }
      if (!file) {
        status.textContent = 'Please select a video file.'; status.className = 'mt-4 text-center text-red-600'; return;
      }
      if (file.size > 100 * 1024 * 1024) {
        status.textContent = 'Video must be under 100MB.'; status.className = 'mt-4 text-center text-red-600'; return;
      }

      status.textContent = 'Processing video...'; status.className = 'mt-4 text-center text-blue-600';

      setTimeout(() => {
        try {
          const videoURL = URL.createObjectURL(file);
          const videoCard = document.createElement('div');
          videoCard.className = 'bg-white rounded-xl shadow-lg overflow-hidden';
          videoCard.innerHTML = `
            <div class="video-container">
              <video controls preload="metadata">
                <source src="${videoURL}" type="${file.type}">
                Your browser does not support the video tag.
              </video>
            </div>
            <div class="p-6">
              <h3 class="text-xl font-semibold mb-2">${escapeHtml(title)}</h3>
              <p class="text-gray-600 text-sm">Uploaded just now (local preview)</p>
            </div>
          `;
          const placeholder = grid.querySelector('.border-dashed');
          if (placeholder && placeholder.parentElement === grid) grid.insertBefore(videoCard, placeholder);
          else grid.appendChild(videoCard);

          status.textContent = 'Video uploaded successfully!'; status.className = 'mt-4 text-center text-green-600';
          setTimeout(() => status.classList.add('hidden'), 3000);
          e.target.reset();
        } catch (err) {
          console.error('Upload error:', err);
          status.textContent = 'Upload failed. Please try again.'; status.className = 'mt-4 text-center text-red-600';
        }
      }, 800);
    });

    // Use repository media button
    document.getElementById('useRepoMedia').addEventListener('click', () => {
      // logo
      const logo = document.getElementById('siteLogo');
      logo.src = 'logo.png';

      // audio
      audio.src = 'bgm.mp3';
      audio.load();
      showNotification('Repository media applied. Click play to start background music.');

      // ensure repo teaser card exists and points to teaser.mp4
      const repoCard = document.getElementById('repoTeaserCard');
      if (repoCard) {
        const source = repoCard.querySelector('video source');
        if (source) {
          source.src = 'teaser.mp4';
          const videoEl = repoCard.querySelector('video');
          videoEl.load();
        }
      } else {
        const grid = document.getElementById('videoGrid');
        const card = document.createElement('div');
        card.className = 'bg-white rounded-xl shadow-lg overflow-hidden';
        card.innerHTML = `
          <div class="video-container">
            <video controls preload="metadata">
              <source src="teaser.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="p-6">
            <h3 class="text-xl font-semibold mb-2">Teaser</h3>
            <p class="text-gray-600 text-sm">From repository: teaser.mp4</p>
          </div>
        `;
        const placeholder = grid.querySelector('.border-dashed');
        if (placeholder && placeholder.parentElement === grid) grid.insertBefore(card, placeholder);
        else grid.appendChild(card);
      }
    });

    // Contact form (local-only)
    function handleSubmit(event) {
      event.preventDefault();
      const name = document.getElementById('name').value.trim();
      const formMessage = document.getElementById('formMessage');
      formMessage.classList.remove('hidden');
      formMessage.textContent = `Thanks, ${name || 'friend'}! Your message is sent. I'll reply soon!`;
      event.target.reset();
      setTimeout(() => formMessage.classList.add('hidden'), 5000);
    }
  </script>
</body>
</html>
